<!doctype html> 
<html lang="en"> 
<head> 
    <meta charset="UTF-8" />
    <title>Phaser - Making your first game, part 7</title>
    <script type="text/javascript" src="js/phaser.min.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>
arrow key-Move   shift&arrowkeys -attack   upkey-jump
<script type="text/javascript">
var game = new Phaser.Game(800, 600, Phaser.AUTO, '', { preload: preload, create: create, update: update });
function preload() {
    game.load.image('sky', 'assets/sky.png');
    game.load.image('ground', 'assets/platform.png');
    game.load.spritesheet('ichigo', 'assets/ichigo.png', 72, 0);
    game.load.spritesheet('enemy', 'assets/slime.png', 90, 0);
    game.load.spritesheet('wave', 'assets/wave.png', 45, 0);
    game.load.audio("plasma",'assets/plasma.mp3')
}
var player;
var enemy;
var wave;
var waveAttack=false;
var platforms;
var cursors;
var score = 0;
var scoreText;
function fireBullet () {

    if (game.time.now > bulletTime)
    {
        bullet = bullets.getFirstExists(false);

        if (bullet)
        {
            bullet.reset(sprite.x + 6, sprite.y - 8);
            bullet.body.velocity.y = -300;
            bulletTime = game.time.now + 250;
        }
    }

}

//  Called if the bullet goes out of the screen
function resetBullet (bullet) {

    bullet.kill();

}

function create() {
    //  We're going to be using physics, so enable the Arcade Physics system
    game.physics.startSystem(Phaser.Physics.ARCADE);
    //  A simple background for our game
    game.add.sprite(0, 0, 'sky');
    //  The platforms group contains the ground and the 2 ledges we can jump on
    platforms = game.add.group();
    //  We will enable physics for any object that is created in this group
    platforms.enableBody = true;
    // Here we create the ground.
    var ground = platforms.create(0, game.world.height - 64, 'ground');
    //  Scale it to fit the width of the game (the original sprite is 400x32 in size)
    ground.scale.setTo(2, 2);
    //  This stops it from falling away when you jump on it
    ground.body.immovable = true;
    // The player and its settings
    player = game.add.sprite(300, game.world.height - 150, 'ichigo');
    //  We need to enable physics on the player
    game.physics.arcade.enable(player);
    //  Player physics properties. Give the little guy a slight bounce.
    player.body.bounce.y = 0.1;
    player.body.gravity.y = 975;
    player.body.collideWorldBounds = true;
    // Player Animations
    player.animations.add('stand', [0, 1, 2, 3], 10, true);
    player.animations.add('run', [4, 5, 6, 7, 8, 9, 10], 10, true);
    player.animations.add('attack', [12, 13, 14, 15, 16, 17, 18], 15, false);
    //player direction
    player.anchor.setTo(.4,.4);
    //  Finally some stars to collect
    enemy = game.add.group();
    waves = game.add.group();

    //  We will enable physics for any star that is created in this group
    enemy.enableBody = true;
    waves.enableBody = true;
    //  Our controls.
    cursors = game.input.keyboard.createCursorKeys();
    
    //  The score
    scoreText = game.add.text(16, 16, 'score: 0', { fontSize: '32px', fill: '#000' });

}
var Finish;
var direction=0;
var attack=0;
function collidewave (obj1, obj2) 
{    
    obj1.kill();
    obj2.kill();
    score += 10;
    scoreText.text = 'Score: ' + score;
}
function collidePlayer (obj1, obj2) 
{    
    obj1.kill();
    obj2.kill();
    Finish = game.add.text(320, 320, 'You Lose', { fontSize: '1000px', fill: '#621' });
}
function spawnEnemy(one, two)
{
    var enem = enemy.create(one , game.world.height - 150, 'enemy');
    enem.animations.add('walking', [0, 1, 2, 3, 4, 5], 10, true);
    enem.animations.play('walking');

    game.physics.arcade.enable(enem);
    game.debug.body(enem)

    if(player.body.x - enem.body.x>0)
    {
        enem.body.velocity.x = 50;
        enem.scale.x=-1;
    }else{
        enem.body.velocity.x = -50;
    }
    
}
function update()
{
    var x = Math.floor((Math.random() * 500) + 1);
    var z = Math.floor((Math.random() * 100) + 1);
    if(x<5)
    {
            spawnEnemy(7*z);
    }
    //  Collide the player and the stars with the platforms
    game.physics.arcade.collide(player, platforms);
    game.physics.arcade.overlap(waves, enemy, collidewave, null, this);
    game.physics.arcade.overlap(player, enemy, collidePlayer, null, this);

    //  Reset the players velocity (movement)
    player.body.velocity.x = 0;
    if((cursors.left.isDown && cursors.left.shiftKey) && waveAttack==false)
    {
        if(direction==0)
        {
            player.scale.x *= -1;
            direction=1;
        }
        player.animations.play('attack');
        player.events.onAnimationComplete.add(function()
        {
            waveAttack=true;        
        }, this);             
    }
    else if((cursors.right.isDown && cursors.right.shiftKey) && waveAttack==false)
    {
        if(direction==1)
        {
            player.scale.x *= -1;
            direction=0;
        }
        player.animations.play('attack');
        player.events.onAnimationComplete.add(function()
        {
            waveAttack=true;        
        }, this);

    }
    else if (cursors.left.isDown)
    {
        //  Move to the left
        player.body.velocity.x = -150;
        if(direction==0)
        {
            player.scale.x *= -1;
            direction=1;
        }
        player.animations.play('run');
    }
    else if (cursors.right.isDown)
    {
        //  Move to the right
        if(direction==1)
        {
            player.scale.x *= -1;
            direction=0;
        }
        player.body.velocity.x = 150;
        player.animations.play('run');
    }
    else
    {
        //  Stand still
        player.animations.play('stand');
    }
    
    //  Allow the player to jump if they are touching the ground.
    if (cursors.up.isDown && player.body.touching.down)
    {
        player.body.velocity.y = -350;
    }

    if(waveAttack==true)
    {
        if(direction==0)
        {
            var wave = waves.create(player.body.x+50 , player.body.y, 'wave');

            wave.animations.add('walking', [0, 1], 10, true);
            wave.animations.play('walking');
            game.physics.arcade.enable(wave);
            var sound =game.add.audio("plasma");
            sound.play();
            wave.body.velocity.x = 500;
            waveAttack=false;
        }
        if(direction==1)
        {
            var wave = waves.create(player.body.x+50 , player.body.y, 'wave');
            wave.scale.x *= -1;
            wave.animations.add('walking', [0, 1], 10, true);
            wave.animations.play('walking');
            game.physics.arcade.enable(wave);
            var sound =game.add.audio("plasma");
            sound.play();

            wave.body.velocity.x = -500;
            waveAttack=false;
        }
    }
}
</script>
<div id="game">
    
</div>
<p> 
 <h5>High Concept:</h5> This will be an action game where the player will have to kill the most amount of mobs 
</p> 
<p> 
<h5>Player Experience Goals:</h5> The player should ecperience a thriller with a lot of real time action. 
</p> 
<p> 
<h5>Genre:</h5> This is a action genre game. 16 </p> 
 <p> 
  <h5>Game play:</h5> This game play is very simple. All that is required is that the player is able to move two different directions and jump and if he holds shift and an arrow key, then he can attack in both directions. When the player touches an enemy, then the enemy will die and the player will gather points. enemies will randomly spawn in random locations.   
 </p> 
 <p> 
  <h5>Prototype goal:</h5> The prototype is to start to understand phaser 
 </p> 
 <p> 
  <h5>Features:</h5> This game doesnt have any unique parts to it yet 
 <p> 
  <h5>Setting/Premise:</h5> This game is set in a flat stage with nothing special in it. it uses characters from bleach and maplestory as players. 
 </p> 
 <p> 
  <h5>Story:</h5> No active story 
 <p>   <h5>Target Audience:</h5> The target audience is for anyone who like action games, probably kids in their teens and anime fans 
 </p> 
 <p> 
  <h5>Play time:</h5> This game will take an average of 5 minutes 
 </p> 
 <p> 
  <h5>Strategies:</h5> The main strategie is to avoid all the enemys and kill them with attacks 
 </p> 
 <p> 
  <h5>Prototype Assets:</h5> http://axellkl.deviantart.com/art/sprite-sheet-ichigo-jus-259949302 
 http://sharethefiles.com/forum/viewtopic.php?t=170642 
 </p> 
 <p> 
  <h5>Prototype Closest Other Game:</h5> This is closely related to the tutorial example in the phaser website and does not work properly on chrome but works fine on ie 
 </p> 

</body>
</html>